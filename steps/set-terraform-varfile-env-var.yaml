parameters:
  - name: terraformVarFile
  - name: environment

steps:
  - bash: |
      ${{ if ne('${{ parameters.terraformVarFile }}', '') }}:
        TERRAFORM_VAR_FILE=${{ parameters.terraformVarFile }}
      ${{ if eq('${{ parameters.terraformVarFile }}', '') }}:
        TERRAFORM_VAR_FILE=$(System.DefaultWorkingDirectory)/$(buildRepoSuffix)/environments/${{ parameters.environment }}/$(tfVarsName).tfvars
      echo "##vso[task.setvariable variable=tfVarFile]$TERRAFORM_VAR_FILE"
    displayName: Set terraform var-file env variable
